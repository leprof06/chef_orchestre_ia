<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>🔍 Optimisation du projet</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background: #f9f9f9; color: #333; }
    h1 { font-size: 24px; color: #444; }
    label, select, button, textarea { display: block; margin-top: 1em; }
    select, textarea { width: 100%; padding: 0.5em; font-size: 16px; }
    button { padding: 0.5em 1em; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    .proposition { background: #fff; padding: 1em; border: 1px solid #ddd; margin-top: 2em; border-radius: 5px; }
    pre { background: #eee; padding: 1em; overflow-x: auto; border-radius: 5px; }
  </style>
</head>
<body>
  <h1>🧪 Optimisation d'un projet IA</h1>
  <form method="post">
    <label for="project">Sélectionne un projet :</label>
    <select name="project" id="project">
      {% for p in project_list %}
        <option value="{{ p }}" {% if p == selected_project %}selected{% endif %}>{{ p }}</option>
      {% endfor %}
    </select>
    <button type="submit">🚀 Lancer l'analyse complète</button>
  </form>

  {% for file, suggestion in proposals.items() %}
    <div class="proposition">
      <h2>📁 Suggestion pour {{ file }}</h2>
      <pre>{{ suggestion }}</pre>
      <form action="/apply_improvement" method="post">
        <input type="hidden" name="filename" value="{{ file }}">
        <input type="submit" value="✅ Appliquer cette optimisation">
      </form>
      <form action="/custom_feedback" method="post">
        <input type="hidden" name="filename" value="{{ file }}">
        <textarea name="custom_prompt" placeholder="💬 Donne une consigne personnalisée (ex : ne pas toucher aux imports, reformule les commentaires, etc.)"></textarea>
        <input type="submit" value="🔁 Re-générer avec cette consigne">
      </form>
    </div>
  {% endfor %}

  <p><a href="/">⬅️ Retour au tableau de bord</a></p>
</body>
</html>
